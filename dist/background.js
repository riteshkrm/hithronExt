chrome.runtime.onMessage.addListener((o,r,n)=>{o.action==="googleLogin"&&chrome.identity.getAuthToken({interactive:!0},function(e){if(chrome.runtime.lastError){console.error(chrome.runtime.lastError);return}chrome.storage.local.set({loggedIn:!0,token:e}),chrome.storage.local.get(["token"],t=>{console.log(t.token)}),chrome.tabs.create({url:chrome.runtime.getURL("index.html#/dashboard")})}),o.action==="logout"&&chrome.storage.local.get("token",e=>{e.token&&fetch(`https://accounts.google.com/o/oauth2/revoke?token=${e.token}`).then(()=>{chrome.identity.removeCachedAuthToken({token:e.token},()=>{chrome.storage.local.clear(()=>{chrome.tabs.create({url:chrome.runtime.getURL("login.html")})})})})})});chrome.runtime.sendMessage({type:"LOGIN_SUCCESS"});
